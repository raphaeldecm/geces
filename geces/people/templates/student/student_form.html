{% extends "base.html" %}

{% load i18n %}
{% load bootstrap5 %}
{% load save_cancel_buttons %}
{% load breadcrumb_item %}

{% block head %}
  <title>{% translate "Cadastro de Discentes" %}</title>
{% endblock head %}
{% block breadcrumbs %}
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      {% breadcrumb_item text="PÃ¡gina Inicial" url="home" %}
      {% breadcrumb_item text="Pessoas" url="people:people_home" %}
      {% breadcrumb_item text="Lista de Discentes" url="people:student_list" %}
      {% breadcrumb_item text="Cadastro de Discentes" active="active" %}
    </ol>
  </nav>
{% endblock breadcrumbs %}
{% block content %}
  {% block alerts %}
    {% include "layouts/alerts.html" %}
  {% endblock alerts %}
  <div class="card card-primary mx-3">
    <div class="card-header">
      <h3 class="card-title">Cadastro de Discente</h3>
    </div>
    <div class="card-body p-0 mt-3">
      <form method="post">
        {% csrf_token %}
        <div class="row mx-auto mb-3">
          <div class="col-12 col-sm-6">{% bootstrap_field form.name %}</div>
          <div class="col-12 col-sm-6">{% bootstrap_field form.email %}</div>
        </div>
        <div class="row mx-auto mb-3">
          <div class="col-12 col-sm-6">{% bootstrap_field form.birth %}</div>
          <div class="col-12 col-sm-6">{% bootstrap_field form.gender %}</div>
        </div>
        {% include "people/_address_form.html" %}
        <div class="row mx-auto mb-3">
          <div class="col-12 col-sm-6">{% bootstrap_field form.responsible %}</div>
        </div>
        
        {% url "people:student_list" as student_list %}
        {% save_cancel_buttons link_back=student_list has_form=True %}
      </form>
    </div>
  </div>
{% endblock content %}

{% block extra_js %}
  <script src="https://cdn.rawgit.com/xcash/bootstrap-autocomplete/3de7ad37/dist/latest/bootstrap-autocomplete.js"></script>
  
  <script>
    $(document).ready(function() {
        $('#id_responsible').autocomplete({
            source: function(request, response) {
                $.ajax({
                    url: "{% url 'people:autocomplete' %}",
                    dataType: 'json',
                    data: {
                        term: request.term
                    },
                    success: function(data) {
                        response(data);
                    }
                });
            },
            minLength: 3
        });
    });
  </script>
{% endblock extra_js %}
